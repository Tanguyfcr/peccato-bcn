<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peccato Italiano | Gestión de Carta Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Dancing+Script:wght@700&family=Plus+Jakarta+Sans:wght@300;400;700&family=Special+Elite&display=swap" rel="stylesheet">
    <style>
        :root {
            --menu-green: #0a1a12;
            --menu-red: #e31e24;
            --menu-orange: #f37021;
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--menu-green);
            color: #fff;
            scroll-behavior: smooth;
        }

        .font-header { font-family: 'Special Elite', cursive; }
        .font-logo-bold { font-family: 'Bangers', cursive; letter-spacing: 2px; }
        .font-script { font-family: 'Dancing Script', cursive; }

        .bg-menu-texture {
            background-image: linear-gradient(rgba(10, 26, 18, 0.9), rgba(10, 26, 18, 0.98)), url('https://www.transparenttextures.com/patterns/dark-wood.png');
        }

        .hero-bg {
            background: linear-gradient(rgba(10, 26, 18, 0.5), var(--menu-green)), url('https://images.unsplash.com/photo-1541745537411-b8046dc6d66c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
        }

        .red-block {
            background-color: var(--menu-red);
            border-radius: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .pizza-name {
            color: var(--menu-red);
            font-weight: 800;
            text-transform: uppercase;
        }

        .price-tag {
            color: #fff;
            font-weight: 700;
        }

        .nav-glass {
            background: rgba(10, 26, 18, 0.85);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .btn-order {
            background: var(--menu-red);
            transition: all 0.3s ease;
        }
        
        .btn-order:hover { transform: scale(1.05); background: #ff2e35; }

        .tab-active { background-color: white !important; color: black !important; }

        .admin-edit-outline { outline: 2px dashed #f37021; outline-offset: 4px; border-radius: 4px; }
        .admin-badge { background: #f37021; color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading-ring {
            display: inline-block;
            width: 80px;
            height: 80px;
        }
        .loading-ring:after {
            content: " ";
            display: block;
            width: 64px;
            height: 64px;
            margin: 8px;
            border-radius: 50%;
            border: 6px solid var(--menu-red);
            border-color: var(--menu-red) transparent var(--menu-red) transparent;
            animation: loading-ring 1.2s linear infinite;
        }
        @keyframes loading-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #admin-bar {
            background: #111;
            border-bottom: 2px solid var(--menu-orange);
        }

        .modal-overlay {
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(8px);
        }
    </style>
</head>
<body class="bg-menu-texture">

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-zinc-900 border border-white/10 p-8 rounded-[2rem] w-full max-w-sm shadow-2xl">
            <h3 class="font-header text-2xl mb-2 text-center text-white uppercase">Acceso Privado</h3>
            <p class="text-stone-500 text-[10px] text-center mb-8 tracking-widest uppercase italic">Solo personal autorizado</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-[10px] uppercase text-stone-400 mb-1 ml-1 font-bold">Usuario</label>
                    <input type="text" id="login-user" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-orange-500 transition">
                </div>
                <div>
                    <label class="block text-[10px] uppercase text-stone-400 mb-1 ml-1 font-bold">Contraseña</label>
                    <input type="password" id="login-pass" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-orange-500 transition">
                </div>
                <div id="login-error" class="hidden text-red-500 text-[10px] text-center font-bold">Credenciales incorrectas</div>
                <div class="flex gap-2 pt-4">
                    <button onclick="window.closeLogin()" class="flex-1 bg-stone-800 text-white py-3 rounded-xl font-bold text-xs uppercase hover:bg-stone-700 transition">Cerrar</button>
                    <button onclick="window.attemptLogin()" class="flex-1 bg-orange-600 text-white py-3 rounded-xl font-bold text-xs uppercase hover:bg-orange-500 transition shadow-lg shadow-orange-600/20">Entrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-zinc-900 border border-orange-500/30 p-8 rounded-[2rem] w-full max-w-sm shadow-2xl">
            <h3 class="font-header text-2xl mb-2 text-center text-white uppercase">Configuración</h3>
            <p class="text-stone-500 text-[10px] text-center mb-8 tracking-widest uppercase italic">Cambiar credenciales de acceso</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-[10px] uppercase text-stone-400 mb-1 ml-1 font-bold">Nuevo Usuario</label>
                    <input type="text" id="new-user" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-green-500 transition">
                </div>
                <div>
                    <label class="block text-[10px] uppercase text-stone-400 mb-1 ml-1 font-bold">Nueva Contraseña</label>
                    <input type="password" id="new-pass" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-green-500 transition">
                </div>
                <div class="flex gap-2 pt-4">
                    <button onclick="window.closeSettings()" class="flex-1 bg-stone-800 text-white py-3 rounded-xl font-bold text-xs uppercase hover:bg-stone-700 transition">Cancelar</button>
                    <button onclick="window.updateCredentials()" class="flex-1 bg-green-600 text-white py-3 rounded-xl font-bold text-xs uppercase hover:bg-green-500 transition">Actualizar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard Bar -->
    <div id="admin-bar" class="fixed top-0 left-0 w-full z-[60] hidden py-2 px-6 shadow-2xl border-b border-white/5">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <span class="admin-badge">GESTIÓN DE CARTA</span>
                <p id="current-admin-user" class="text-[9px] text-stone-400 uppercase font-bold tracking-widest"></p>
            </div>
            <div class="flex gap-2">
                <button onclick="window.openSettings()" class="bg-stone-800 text-stone-300 px-3 py-1.5 rounded-lg hover:bg-stone-700 transition text-[10px] uppercase font-bold" title="Configuración de acceso">
                    <i class="fas fa-cog"></i>
                </button>
                <button id="save-btn" onclick="window.saveChanges()" class="bg-green-600 text-white px-4 py-1.5 rounded-lg font-bold text-[10px] uppercase hover:bg-green-500 transition shadow-lg">
                    <i class="fas fa-save mr-1"></i> Guardar
                </button>
                <button onclick="window.logoutAdmin()" class="bg-stone-800 text-stone-300 px-4 py-1.5 rounded-lg font-bold text-[10px] uppercase hover:bg-red-900 hover:text-white transition">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Navbar -->
    <nav id="main-nav" class="fixed w-full z-50 nav-glass transition-all duration-300">
        <div class="max-w-7xl mx-auto px-6 h-20 flex justify-between items-center">
            <div class="flex items-center">
                <div class="flex flex-col items-center cursor-pointer" onclick="window.scrollTo(0,0)">
                    <span class="font-logo-bold text-3xl text-white leading-none">PECCATO</span>
                    <span class="font-script text-2xl text-white -mt-1 leading-none">Italiano</span>
                </div>
            </div>
            
            <div class="hidden md:flex space-x-8 font-header text-sm tracking-widest text-stone-300">
                <a href="#menu" class="hover:text-red-500 transition">La Carta</a>
                <a href="#horarios" class="hover:text-red-500 transition">Horarios</a>
                <a href="#contacto" class="hover:text-red-500 transition">Ubicación</a>
            </div>

            <div class="flex items-center gap-4">
                <a href="tel:610484299" class="btn-order px-6 py-2 rounded-full font-bold text-white text-xs uppercase tracking-tighter">
                    Llamar Ahora
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero-bg h-[70vh] flex items-center justify-center text-center px-4">
        <div class="max-w-3xl">
            <h1 class="font-header text-4xl md:text-6xl mb-4 text-white">PIZZERIA ITALIANA</h1>
            <div class="w-24 h-1 bg-red-600 mx-auto mb-8"></div>
            <p class="font-script text-4xl md:text-5xl text-orange-400 mb-8 italic">Un bocado de cielo, un pecado necesario...</p>
        </div>
    </section>

    <!-- Menu Section -->
    <section id="menu" class="py-20 px-4 min-h-screen">
        <div class="max-w-7xl mx-auto">
            
            <div id="error-box" class="hidden max-w-lg mx-auto bg-red-900/40 border border-red-500 p-8 rounded-3xl text-center mb-10 fade-in">
                <i class="fas fa-exclamation-triangle text-3xl text-red-500 mb-4"></i>
                <p id="error-message" class="text-sm text-red-200 mb-6"></p>
                <button onclick="window.location.reload()" class="bg-white text-red-900 px-6 py-2 rounded-full text-xs font-bold uppercase hover:bg-stone-200">Reintentar</button>
            </div>

            <div id="loading-spinner" class="text-center py-20">
                <div class="loading-ring"></div>
                <p class="font-header uppercase text-sm tracking-widest mt-4 opacity-50 text-white/50">Sincronizando la carta...</p>
            </div>

            <div id="menu-content" class="hidden grid lg:grid-cols-12 gap-12 fade-in">
                
                <!-- Column: Estrellas -->
                <div class="lg:col-span-5">
                    <div class="red-block p-8 md:p-12 lg:sticky lg:top-28">
                        <div class="flex justify-between items-start mb-10 border-b border-black/10 pb-4">
                            <h2 class="font-header text-4xl text-black/90 uppercase">Estrellas <br><span class="text-white">de la Casa</span></h2>
                            <button onclick="addItem('estrellas')" class="admin-only hidden bg-black text-white w-10 h-10 flex items-center justify-center rounded-full shadow-lg hover:scale-110 transition"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="space-y-10" id="estrellas-list"></div>
                    </div>
                </div>

                <!-- Column: Categories -->
                <div class="lg:col-span-7">
                    <div class="flex flex-wrap gap-3 mb-12" id="tabs-container">
                        <button onclick="changeTab('pizzas')" class="px-5 py-2 rounded-full border border-white/20 font-header text-[11px] tracking-widest tab-active" id="tab-pizzas">PIZZAS</button>
                        <button onclick="changeTab('calzone')" class="px-5 py-2 rounded-full border border-white/20 font-header text-[11px] tracking-widest" id="tab-calzone">CALZONE</button>
                        <button onclick="changeTab('dulce')" class="px-5 py-2 rounded-full border border-white/20 font-header text-[11px] tracking-widest" id="tab-dulce">POSTRES</button>
                        <button onclick="changeTab('bebidas')" class="px-5 py-2 rounded-full border border-white/20 font-header text-[11px] tracking-widest" id="tab-bebidas">BEBIDAS</button>
                    </div>

                    <div class="admin-only hidden mb-6">
                        <button onclick="addItem(currentTab)" class="bg-white/10 text-white border border-white/20 px-6 py-3 rounded-2xl font-bold text-xs uppercase hover:bg-white/20 transition w-full text-center">
                            <i class="fas fa-plus-circle mr-2"></i> Añadir plato a esta sección
                        </button>
                    </div>

                    <div class="grid gap-8" id="dynamic-menu"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Info -->
    <section id="horarios" class="py-24 bg-black/40">
        <div class="max-w-5xl mx-auto px-6 grid md:grid-cols-2 gap-16">
            <div>
                <h3 class="font-header text-2xl mb-8 text-red-600">HORARIOS</h3>
                <div class="space-y-6 text-stone-300">
                    <div class="flex justify-between border-b border-white/5 pb-3">
                        <span class="uppercase text-[11px] tracking-widest font-bold">Lun - Mar</span>
                        <span class="text-red-500 italic font-bold">Cerrado</span>
                    </div>
                    <div class="flex justify-between border-b border-white/5 pb-3">
                        <span class="uppercase text-[11px] tracking-widest font-bold">Mié - Dom</span>
                        <span class="text-sm">13:30 – 16:00 / 19:30 – 23:00</span>
                    </div>
                </div>
            </div>
            <div>
                <h3 class="font-header text-2xl mb-6 uppercase tracking-tighter">Ubicación</h3>
                <p class="text-stone-300 text-lg mb-8">Ronda del Guinardó, 19, B3<br>08024 Barcelona</p>
                <a href="tel:610484299" class="bg-white text-black px-8 py-3 rounded-2xl font-bold hover:bg-stone-200 transition text-sm">LLAMAR AL RESTAURANTE</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contacto" class="py-20 border-t border-white/5 bg-black/60">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <div class="mb-12 flex flex-col items-center">
                <span class="font-logo-bold text-4xl text-white">PECCATO</span>
                <span class="font-script text-3xl text-white -mt-2">Italiano</span>
            </div>
            
            <button onclick="window.openLogin()" id="owner-access-btn" class="text-[9px] text-stone-700 uppercase tracking-widest hover:text-stone-400 transition-colors py-3 px-8 border border-white/5 rounded-full">Acceso Propietario</button>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // CONFIGURATION
        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'pizzeria-peccato';

        // APP STATE
        window.menuData = null;
        window.adminSettings = { user: "admin", pass: "admin123" };
        window.currentTab = 'pizzas';
        window.isAdmin = sessionStorage.getItem('isPeccatoAdmin') === 'true';

        const defaultMenu = {
            estrellas: [
                { id: 1, name: "CRUDO DI PARMA", price: "17,50€", desc: "Pesto albahaca, ajo, tomatitos. Prosciutto di Parma, burrata, nueces.", available: true }
            ],
            pizzas: [
                { id: 2, name: "MARGHERITA", price: "9,90€", desc: "Tomate San Marzano, mozzarella fior di latte, albahaca.", available: true }
            ],
            calzone: [], dulce: [], bebidas: []
        };

        // --- AUTH & SYNC ---

        const startApp = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (err) { console.error("Auth Fail", err); }
        };

        startApp();

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Initialize/Fetch Settings (Admin Credentials)
                const settingsRef = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main');
                try {
                    const setSnap = await getDoc(settingsRef);
                    if (setSnap.exists()) {
                        window.adminSettings = setSnap.data();
                    } else {
                        // Create default settings if empty
                        await setDoc(settingsRef, window.adminSettings);
                    }
                } catch (e) {
                    console.warn("Settings fetch failed (likely rules). Using defaults.");
                }

                // Sync Menu
                const menuRef = doc(db, 'artifacts', appId, 'public', 'data', 'menu', 'main');
                onSnapshot(menuRef, (snap) => {
                    window.menuData = snap.exists() ? snap.data().content : defaultMenu;
                    document.getElementById('loading-spinner').classList.add('hidden');
                    document.getElementById('menu-content').classList.remove('hidden');
                    render();
                }, (err) => showError("Error de conexión a la base de datos."));
            }
        });

        function showError(msg) {
            document.getElementById('loading-spinner').classList.add('hidden');
            document.getElementById('error-box').classList.remove('hidden');
            document.getElementById('error-message').innerText = msg;
        }

        // --- INTERFACE RENDERING ---

        window.render = () => {
            if (!window.menuData) return;
            
            const estrellas = document.getElementById('estrellas-list');
            estrellas.innerHTML = window.menuData.estrellas.map(i => itemTemplate(i, 'estrellas', true)).join('');
            
            const dynamic = document.getElementById('dynamic-menu');
            dynamic.innerHTML = window.menuData[window.currentTab].map(i => itemTemplate(i, window.currentTab, false)).join('');
            
            refreshAdminUI();
        };

        function itemTemplate(item, category, isEstrella) {
            if (!item.available && !window.isAdmin) return '';
            
            const opacity = item.available ? '' : 'opacity-25 grayscale scale-95';
            const editable = window.isAdmin ? 'contenteditable="true" spellcheck="false"' : '';
            const border = window.isAdmin ? 'admin-edit-outline px-1' : '';
            
            if (isEstrella) {
                return `
                    <div class="${opacity} fade-in">
                        <div class="flex justify-between items-baseline mb-1 ${border}">
                            <h4 onblur="window.updateValue('${category}', ${item.id}, 'name', this.innerText)" ${editable} class="font-bold text-white text-lg outline-none">${item.name}</h4>
                            <span onblur="window.updateValue('${category}', ${item.id}, 'price', this.innerText)" ${editable} class="text-white font-bold ml-2 outline-none">${item.price}</span>
                        </div>
                        <p onblur="window.updateValue('${category}', ${item.id}, 'desc', this.innerText)" ${editable} class="text-black/70 text-xs italic font-medium outline-none leading-snug">${item.desc}</p>
                        ${window.isAdmin ? `<div class="mt-3 flex gap-4 text-[9px] font-bold text-black/50 uppercase tracking-tighter">
                            <button onclick="window.toggleStock('${category}', ${item.id})" class="hover:text-white transition">${item.available ? 'En Carta' : 'Agotado'}</button>
                            <button onclick="window.removeDish('${category}', ${item.id})" class="text-red-900 hover:text-white transition">Eliminar</button>
                        </div>` : ''}
                    </div>`;
            } else {
                return `
                    <div class="border-b border-white/5 pb-6 ${opacity} fade-in">
                        <div class="flex justify-between items-baseline mb-2 ${border}">
                            <h4 onblur="window.updateValue('${category}', ${item.id}, 'name', this.innerText)" ${editable} class="pizza-name text-lg outline-none">${item.name}</h4>
                            <span onblur="window.updateValue('${category}', ${item.id}, 'price', this.innerText)" ${editable} class="price-tag outline-none">${item.price}</span>
                        </div>
                        <p onblur="window.updateValue('${category}', ${item.id}, 'desc', this.innerText)" ${editable} class="text-stone-400 text-sm font-light outline-none">${item.desc}</p>
                        ${window.isAdmin ? `<div class="mt-2 flex gap-4 text-[9px] font-bold text-white/20 uppercase">
                            <button onclick="window.toggleStock('${category}', ${item.id})">${item.available ? 'Visible' : 'Oculto'}</button>
                            <button onclick="window.removeDish('${category}', ${item.id})" class="text-red-500 hover:text-white transition">Borrar</button>
                        </div>` : ''}
                    </div>`;
            }
        }

        // --- MANAGEMENT ACTIONS ---

        window.openLogin = () => { document.getElementById('login-modal').classList.remove('hidden'); };
        window.closeLogin = () => { document.getElementById('login-modal').classList.add('hidden'); };

        window.attemptLogin = () => {
            const user = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value.trim();
            if (user === window.adminSettings.user && pass === window.adminSettings.pass) {
                window.isAdmin = true;
                sessionStorage.setItem('isPeccatoAdmin', 'true');
                window.closeLogin();
                window.render();
            } else {
                const err = document.getElementById('login-error');
                err.classList.remove('hidden');
                setTimeout(() => err.classList.add('hidden'), 3000);
            }
        };

        window.logoutAdmin = () => {
            window.isAdmin = false;
            sessionStorage.removeItem('isPeccatoAdmin');
            window.render();
        };

        function refreshAdminUI() {
            const bar = document.getElementById('admin-bar');
            const nav = document.getElementById('main-nav');
            const userBadge = document.getElementById('current-admin-user');
            if (window.isAdmin) {
                bar.classList.remove('hidden');
                nav.style.top = '44px';
                userBadge.innerText = "HOLA, " + window.adminSettings.user;
            } else {
                bar.classList.add('hidden');
                nav.style.top = '0';
            }
            document.querySelectorAll('.admin-only').forEach(el => window.isAdmin ? el.classList.remove('hidden') : el.classList.add('hidden'));
        }

        // Settings (Username/Password Change)
        window.openSettings = () => { 
            document.getElementById('new-user').value = window.adminSettings.user;
            document.getElementById('new-pass').value = window.adminSettings.pass;
            document.getElementById('settings-modal').classList.remove('hidden'); 
        };
        window.closeSettings = () => { document.getElementById('settings-modal').classList.add('hidden'); };
        
        window.updateCredentials = async () => {
            const u = document.getElementById('new-user').value.trim();
            const p = document.getElementById('new-pass').value.trim();
            if (u && p) {
                window.adminSettings = { user: u, pass: p };
                const ref = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main');
                try {
                    await setDoc(ref, window.adminSettings);
                    alert("Credenciales actualizadas correctamente.");
                    window.closeSettings();
                    window.render();
                } catch (e) { alert("Error al actualizar credenciales."); }
            } else { alert("Debes completar ambos campos."); }
        };

        window.changeTab = (cat) => {
            window.currentTab = cat;
            document.querySelectorAll('#tabs-container button').forEach(b => b.classList.remove('tab-active'));
            document.getElementById('tab-' + cat).classList.add('tab-active');
            window.render();
        };

        window.updateValue = (cat, id, field, val) => {
            const item = window.menuData[cat].find(i => i.id === id);
            if (item) item[field] = val;
        };

        window.toggleStock = (cat, id) => {
            const item = window.menuData[cat].find(i => i.id === id);
            if (item) item.available = !item.available;
            window.render();
        };

        window.removeDish = (cat, id) => {
            if (confirm("¿Estás seguro de eliminar este plato?")) {
                window.menuData[cat] = window.menuData[cat].filter(i => i.id !== id);
                window.render();
            }
        };

        window.addItem = (cat) => {
            window.menuData[cat].unshift({
                id: Date.now(),
                name: "NUEVO PLATO",
                price: "0,00€",
                desc: "Descripción del plato...",
                available: true
            });
            window.render();
        };

        window.saveChanges = async () => {
            const btn = document.getElementById('save-btn');
            const original = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;
            try {
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'menu', 'main'), { content: window.menuData });
                alert("Menú guardado en la nube con éxito.");
            } catch (e) { alert("Error al guardar la carta."); }
            btn.innerHTML = original;
            btn.disabled = false;
        };
    </script>
</body>
</html>
